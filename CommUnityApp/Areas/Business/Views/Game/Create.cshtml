@model CommUnityApp.ApplicationCore.Models.AddUpdateBrandGameRequest
@{
    ViewData["Title"] = "Create Brand Game";
    Layout = "_BusinessLayout";
}

<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-800 mb-1">Create New Brand Game</h2>
            <p class="text-muted">Set up your interactive game and configure prizes.</p>
        </div>
        <a href="@Url.Action("Index", "Home")" class="btn btn-light rounded-pill px-4 fw-600">
            <i class="fa-solid fa-arrow-left me-2"></i> Back to Dashboard
        </a>
    </div>

    @if (ViewBag.Error != null)
    {
        <div class="alert alert-danger rounded-4 shadow-sm mb-4">
            <i class="fa-solid fa-circle-exclamation me-2"></i> @ViewBag.Error
        </div>
    }

    <form asp-action="Create" method="post" enctype="multipart/form-data" class="game-form">
        <input type="hidden" asp-for="BrandGameID" />

        <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
            <!-- Tab Navigation -->
            <div class="card-header bg-white border-bottom-0 p-0">
                <ul class="nav nav-pills custom-tabs" id="gameTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="general-tab" data-bs-toggle="pill" data-bs-target="#general" type="button" role="tab">
                            <i class="fa-solid fa-info-circle me-2"></i> General Info
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="config-tab" data-bs-toggle="pill" data-bs-target="#config" type="button" role="tab">
                            <i class="fa-solid fa-gears me-2"></i> Game Config
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="primary-tab" data-bs-toggle="pill" data-bs-target="#primary" type="button" role="tab">
                            <i class="fa-solid fa-star me-2"></i> Primary Prize
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="secondary-tab" data-bs-toggle="pill" data-bs-target="#secondary" type="button" role="tab">
                            <i class="fa-solid fa-award me-2"></i> Secondary Prize
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="consolation-tab" data-bs-toggle="pill" data-bs-target="#consolation" type="button" role="tab">
                            <i class="fa-solid fa-gift me-2"></i> Consolation
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="media-tab" data-bs-toggle="pill" data-bs-target="#media" type="button" role="tab">
                            <i class="fa-solid fa-palette me-2"></i> Media & Style
                        </button>
                    </li>
                </ul>
            </div>

            <!-- Tab Content -->
            <div class="card-body p-4">
                <div class="tab-content" id="gameTabsContent">
                    
                    <!-- 1. General Info -->
                    <div class="tab-pane fade show active" id="general" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label asp-for="BrandGame" class="form-label fw-600">Game Name</label>
                                <input asp-for="BrandGame" class="form-control" placeholder="e.g. Summer Sensation" required />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="BrandGameTitle" class="form-label fw-600">Game Subtitle</label>
                                <input asp-for="BrandGameTitle" class="form-control" placeholder="Short catchy phrase" />
                            </div>
                            <div class="col-12">
                                <label asp-for="BrandGameDesc" class="form-label fw-600">Description</label>
                                <textarea asp-for="BrandGameDesc" class="form-control" rows="3" placeholder="Explain the game to users..."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="DateStart" class="form-label fw-600">Start Date</label>
                                <input asp-for="DateStart" type="date" class="form-control" required />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="DateEnd" class="form-label fw-600">End Date</label>
                                <input asp-for="DateEnd" type="date" class="form-control" required />
                            </div>
                        </div>
                    </div>

                    <!-- 2. Game Config -->
                    <div class="tab-pane fade" id="config" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-md-4">
                                <label asp-for="PanelCount" class="form-label fw-600">Panel Count</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0"><i class="fa-solid fa-table-cells"></i></span>
                                    <input asp-for="PanelCount" type="number" class="form-control" min="1" required />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="ChanceCount" class="form-label fw-600">Chances per User</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0"><i class="fa-solid fa-rotate-left"></i></span>
                                    <input asp-for="ChanceCount" type="number" class="form-control" min="1" required />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="PanelOpeningLimit" class="form-label fw-600">Max Openings</label>
                                <input asp-for="PanelOpeningLimit" type="number" class="form-control" min="1" required />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="DestinationUrl" class="form-label fw-600">Destination URL</label>
                                <input asp-for="DestinationUrl" type="url" class="form-control" placeholder="https://yourwebsite.com/success" />
                            </div>
                             <div class="col-md-6">
                                <label asp-for="PromotionalCode" class="form-label fw-600">Promo Code (If any)</label>
                                <input asp-for="PromotionalCode" class="form-control" />
                            </div>
                        </div>
                    </div>

                    <!-- 3. Primary Prize -->
                    <div class="tab-pane fade" id="primary" role="tabpanel">
                        <div class="alert alert-primary bg-opacity-10 border-0 rounded-3 mb-4">
                            <i class="fa-solid fa-circle-info me-2"></i> Configure the grand prize for your lucky winners.
                        </div>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label asp-for="PrimaryOfferText" class="form-label fw-600">Primary Offer Label</label>
                                <input asp-for="PrimaryOfferText" class="form-control" placeholder="e.g. 50% OFF" />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="PrimaryPrizeCount" class="form-label fw-600">Total Available Prizes</label>
                                <input asp-for="PrimaryPrizeCount" type="number" class="form-control" min="0" />
                            </div>
                            <div class="col-12">
                                <label asp-for="PrimaryWinMessage" class="form-label fw-600">Success Message</label>
                                <textarea asp-for="PrimaryWinMessage" class="form-control" rows="2" placeholder="Congratulations! You won the grand prize!"></textarea>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="PrimaryPrizePromotionId" class="form-label fw-600">Promotion Linked ID</label>
                                <input asp-for="PrimaryPrizePromotionId" type="number" class="form-control" />
                            </div>
                        </div>
                    </div>

                    <!-- 4. Secondary Prize -->
                    <div class="tab-pane fade" id="secondary" role="tabpanel">
                         <div class="row g-4">
                            <div class="col-md-6">
                                <label asp-for="OfferText" class="form-label fw-600">Secondary Offer Label</label>
                                <input asp-for="OfferText" class="form-control" placeholder="e.g. $10 Voucher" />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="SecondaryPrizeCount" class="form-label fw-600">Total Available Prizes</label>
                                <input asp-for="SecondaryPrizeCount" type="number" class="form-control" min="0" />
                            </div>
                            <div class="col-12">
                                <label asp-for="SecondaryWinMessage" class="form-label fw-600">Success Message</label>
                                <textarea asp-for="SecondaryWinMessage" class="form-control" rows="2" placeholder="Great job! You won a secondary prize!"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Consolation -->
                    <div class="tab-pane fade" id="consolation" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label asp-for="ConsolationPrizeCount" class="form-label fw-600">Total Consolation Count</label>
                                <input asp-for="ConsolationPrizeCount" type="number" class="form-control" min="0" />
                            </div>
                            <div class="col-md-6">
                                <label asp-for="PointsAwarded" class="form-label fw-600">Points Awarded</label>
                                <input asp-for="PointsAwarded" type="number" class="form-control" min="0" />
                            </div>
                            <div class="col-12">
                                <label asp-for="ConsolationMessage" class="form-label fw-600">Consolation Message</label>
                                <textarea asp-for="ConsolationMessage" class="form-control" rows="2" placeholder="Better luck next time! Here's a small gift..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 6. Media & Style -->
                    <div class="tab-pane fade" id="media" role="tabpanel">
                        <div class="row g-4">
                            <div class="col-md-6">
                                <label class="form-label fw-600">Main Game Image</label>
                                <input type="file" asp-for="BrandGameImageFile" class="form-control" accept="image/*" />
                                <div class="form-text">Will be displayed on the game card.</div>
                            </div>
                             <div class="col-md-6">
                                <label class="form-label fw-600">Unsuccessful / Better Luck Image</label>
                                <input type="file" asp-for="UnSuccessfulImageFile" class="form-control" accept="image/*" />
                            </div>
                            <div class="col-md-6">
                                <div class="p-3 rounded-4 border bg-white shadow-sm">
                                    <label asp-for="FormColor" class="form-label fw-600 d-block">Form Theme Color</label>
                                    <input asp-for="FormColor" type="color" class="form-control form-control-color w-100 border-0" value="#2563eb" />
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="p-3 rounded-4 border bg-white shadow-sm">
                                    <label asp-for="TextColor" class="form-label fw-600 d-block">Primary Text Color</label>
                                    <input asp-for="TextColor" type="color" class="form-control form-control-color w-100 border-0" value="#0f172a" />
                                </div>
                            </div>
                            <div class="col-12 mt-4 text-end">
                                <hr class="my-4 opacity-5" />
                                <button type="submit" class="btn btn-primary btn-lg rounded-pill px-5 fw-800">
                                    <i class="fa-solid fa-rocket me-2"></i> Launch Brand Game
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <style>
        .custom-tabs {
            padding: 10px 20px;
            background: #f8fafc;
            gap: 10px;
        }
        .custom-tabs .nav-link {
            border-radius: 999px;
            font-weight: 700;
            color: #64748b;
            padding: 10px 20px;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        .custom-tabs .nav-link:hover {
            color: var(--primary);
            background: rgba(37, 99, 235, 0.05);
        }
        .custom-tabs .nav-link.active {
            background: #ffffff !important;
            color: var(--primary) !important;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
        }
        .form-label {
            margin-bottom: 8px;
            color: #334155;
        }
        .form-control, .form-select {
            border-radius: 12px;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
        }
        .form-control:focus {
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
            border-color: var(--primary);
        }
        .fw-600 { font-weight: 600; }
        .fw-800 { font-weight: 800; }
    </style>

    <script>
        // Optional: Client-side validation for tab completion or required fields
    </script>
}
